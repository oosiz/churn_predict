# churn_predict
이탈 예측 모델 개발<br>

<h3>📌 프로젝트 목적</h3>
이탈하는 학생을 이탈하지 않을 것이라고 예측했을 때 회사에 직접적으로 오는 피해가 크기 때문에<br>
실제 이탈하는 학생을 이탈이라고 예측을 잘 했는지 알 수 있는 Recall을 주된 평가지표로 두고 모델을 평가하였습니다.

신규/재구매 여부에 따라 이탈에 영향을 줄 것이라고 생각해 재구매 여부를 기준으로 모델을 분리해 학습시켜 평가하였습니다.

<h3>📌 모델</h3>

### 전처리
- 결측치는 모두 0으로 채움
- 'grade_sect_cd', 'mbr_sex_cd', 're_purch' 컬럼은 숫자로 변환
- 'system_id'와 'number' 컬럼은 모델 학습에 사용하지 않음

### 모델구현
- LGBM
- 1차 분리: 're_purch'를 기준으로 신규/재구매 모델로 분리
- 2차 분리: 'mbr_sex_cd'를 기준으로 신규-여자/신규-남자/재구매-여자/재구매-남자 모델로 분리
- 'grade' feature 포함/삭제

<h3>📌 결과</h3>

### 'grade' 포함
### 신규-전체 모델
[Train] 신규, 이탈 : 496, 미이탈 : 37030 <br>
[Test] 신규, 이탈 : 143, 미이탈 : 9239<br>
[Predict] 신규 , 이탈: 129, 미이탈: 9253<br>
신규, acc: 0.9944574717544233, precision: 0.8527131782945736, recall: 0.7692307692307693, f1: 0.8088235294117646<br>

                    예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)         110          33
    실제: 미이탈(0)          19        9220


### 재구매-전체 모델
[Train] 재구매, 이탈 : 236, 미이탈 : 10237<br>
[Test] 재구매, 이탈 : 57, 미이탈 : 2562<br>
[Predict] 재구매 , 이탈: 52, 미이탈: 2567<br>
재구매, acc: 0.9927453226422298, precision: 0.8653846153846154, recall: 0.7894736842105263, f1: 0.8256880733944955<br>

                    예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)          45          12
    실제: 미이탈(0)           7        2555


## 성별 분리
### 'grade' 포함
### 신규-여자 모델
[Train] 신규, 이탈 : 188, 미이탈 : 15211<br>
[Test] 신규, 이탈 : 59, 미이탈 : 3791<br>
[Predict] 신규 , 이탈: 58, 미이탈: 3792<br>
신규, acc: 0.9914285714285714, precision: 0.7241379310344828, recall: 0.711864406779661, f1: 0.717948717948718<br>

            예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)          42          17
    실제: 미이탈(0)          16        3775


### 신규-남자 모델
[Train] 신규, 이탈 : 288, 미이탈 : 20473<br>
[Test] 신규, 이탈 : 82, 미이탈 : 5109<br>
[Predict] 신규 , 이탈: 69, 미이탈: 5122<br>
신규, acc: 0.9951839722596802, precision: 0.9130434782608695, recall: 0.7682926829268293, f1: 0.8344370860927153<br>

            예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)          63          19
    실제: 미이탈(0)           6        5103
### 재구매-여자 모델
[Train] 재구매, 이탈 : 102, 미이탈 : 4851<br>
[Test] 재구매, 이탈 : 28, 미이탈 : 1211<br>
[Predict] 재구매 , 이탈: 26, 미이탈: 1213<br>
재구매, acc: 0.9919289749798225, precision: 0.8461538461538461, recall: 0.7857142857142857, f1: 0.8148148148148148<br>

            예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)          22           6
    실제: 미이탈(0)           4        1207
### 재구매-남자 모델
[Train] 재구매, 이탈 : 127, 미이탈 : 5385<br>
[Test] 재구매, 이탈 : 36, 미이탈 : 1343<br>
[Predict] 재구매 , 이탈: 35, 미이탈: 1344<br>
재구매, acc: 0.990572878897752, precision: 0.8285714285714286, recall: 0.8055555555555556, f1: 0.8169014084507044<br>

            예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)          29           7
    실제: 미이탈(0)           6        1337

성별로 다시 한 번 모델을 분리했을 때 전체 모델과 같이 신규에서의 Recall값이 <b>신규-전체 0.769 -> 신규-여자 0.712, 신규-남자 0.768 </b>
으로 성능 향상이 일어났지만, 재구매에서는 <b>재구매-전체 0.789 -> 재구매-여자 0.786, 재구매-남자 0.806 </b>로 오히려 성능이 떨어지는 결과가 나타났다.


### 'grade' 삭제
### 신규-전체 모델
[Train] 신규, 이탈 : 496, 미이탈 : 37030<br>
[Test] 신규, 이탈 : 143, 미이탈 : 9239<br>
[Predict] 신규 , 이탈: 129, 미이탈: 9253<br>
신규, acc: 0.9950969942442975, precision: 0.875968992248062, recall: 0.7902097902097902, f1: 0.8308823529411764<br>

            예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)         113          30
    실제: 미이탈(0)          16        9223

### 재구매-전체 모델
[Train] 재구매, 이탈 : 236, 미이탈 : 10237<br>
[Test] 재구매, 이탈 : 57, 미이탈 : 2562<br>
[Predict] 재구매 , 이탈: 53, 미이탈: 2566<br>
재구매, acc: 0.9923634975181367, precision: 0.8490566037735849, recall: 0.7894736842105263, f1: 0.8181818181818182<br>

            예측: 이탈 (1)  예측: 미이탈(0)
    실제: 이탈 (1)          45          12
    실제: 미이탈(0)           8        2554


'grade' feature을 삭제했을 때 신규-전체 모델에서 <b>Recall이 0.769 -> 0.790</b> 으로 성능이 향상되었고,<br> 재구매-전체 모델에서 Recall값은 동일하지만 정확도가 미세하게 하락한 결과가 나타났다.


## 결론
- 신규/재구매로 분리후 성별로 분리한 모델의 성능 평가지표를 살펴보면 성능이 크게 향상하지 않고 오히려 떨어지는 결과가 나오기 때문에 성별로 분리하지 않는다.
- 신규/재구매로 분리한 모델에서 'grade' feature을 삭제했을 때, 신규 모델에서는 성능 향상이 일어났지만 재구매 모델에서는 성능이 떨어지는 결과가 나왔으므로 신규 학생을 예측할 때는 'grade' feature을 삭제하는 것이, 재구매 학생 예측할 때는 'grade' feature을 포함시키는 것이 합리적이라고 판단한다.
- 회사에서는 모델 예측을 통해 실제로 이탈하려는 학생을 최대한 예측해 이탈을 방지할 수 있다.

